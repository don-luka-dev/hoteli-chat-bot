@if (soba(); as soba) {
<div class="max-w-5xl mx-auto space-y-6 p-6 bg-white rounded-2xl shadow-lg">
  <h2 class="text-2xl font-semibold text-gray-800">Detalji sobe</h2>

  <div class="space-y-2 text-gray-700">
    <p><strong>Naziv:</strong> {{ soba.naziv }}</p>
    <p><strong>Broj kreveta:</strong> {{ soba.brojKreveta }}</p>
    <p><strong>Cijena noćenja:</strong> {{ soba.cijenaNocenja }} €</p>
    <p><strong>Hotel:</strong> {{ soba.hotelNaziv }}</p>
  </div>

  @if(authService.isAdmin()){
  <div class="pt-2">
    <app-delete-soba [hotelId]="hotelId()" [sobaId]="id()"></app-delete-soba><!-- Ne radi na nekim mjestima zbog rute, jbg -->
  </div>
  }

  <!-- Galerija -->
  @if (slike().length === 0) {
  <div class="text-sm text-gray-500">Ova soba još nema slika.</div>
  } @else {
  <div class="rounded-2xl shadow overflow-hidden">
    <!-- Glavna slika + kontrole -->
    <div class="relative bg-black/5 outline-none" tabindex="0" (keydown)="onKey($event)"
      (pointerdown)="onPointerDown($event)" (pointerup)="onPointerUp($event)">
      <!-- skeleton dok se slika učitava -->
      @if (!imgLoaded()) {
      <div class="absolute inset-0 animate-pulse bg-gray-200"></div>
      }

      <img [src]="slike()[activeIndex()].urlSlike" [alt]="slike()[activeIndex()].naslovSlike || 'Slika'"
        class="w-full h-[420px] object-contain transition-opacity duration-300" [class.opacity-0]="!imgLoaded()"
        loading="lazy" (load)="onImageLoad()" (error)="onImageError($event)" draggable="false" />

      @if (slike().length > 1) {
      <button type="button" (click)="prev()"
        class="absolute left-2 top-1/2 -translate-y-1/2 p-2 rounded-full bg-white/80 hover:bg-white shadow"
        aria-label="Prethodna slika">‹</button>
      <button type="button" (click)="next()"
        class="absolute right-2 top-1/2 -translate-y-1/2 p-2 rounded-full bg-white/80 hover:bg-white shadow"
        aria-label="Sljedeća slika">›</button>
      }
    </div>

    <!-- Thumbnails -->
    <div class="flex gap-2 p-3 overflow-x-auto">
      @for (s of slike(); track s.id; let i = $index) {
      <button type="button" (click)="select(i)" class="relative rounded overflow-hidden border transition ring-offset-2"
        [class.border-transparent]="i === activeIndex()" [class.ring-2]="i === activeIndex()"
        [class.ring-blue-500]="i === activeIndex()" [class.border-gray-200]="i !== activeIndex()"
        title="{{ s.naslovSlike }}">
        <img [src]="s.urlSlike" [alt]="s.naslovSlike || ('Slika ' + (i+1))" class="h-16 w-24 object-cover block"
          loading="lazy" (error)="onImageError($event)" draggable="false" />
      </button>
      }
    </div>
  </div>
  }

  @if(authService.isAdmin()){
  <div class="pt-6">
    <h3 class="text-lg font-semibold text-gray-800 mb-2">Dodaj sliku</h3>
    <app-add-slika-sobe [sobaId]="id()!" (uploaded)="refreshSlike()"></app-add-slika-sobe>
  </div>
  }


  <div class="pt-6">
    <app-add-rezervacija [sobaId]="id()"></app-add-rezervacija>
  </div>

</div>
} @else {
<p class="text-sm text-gray-500 text-center mt-8">Soba nije pronađena.</p>
}